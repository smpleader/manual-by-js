<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="">
        <title>ManualByJS</title> 
        <link href="assets/customized_b5.css" rel="stylesheet">
        <link href="assets/driver.css" rel="stylesheet">
    </head>
    <body class="">
        <div class="">
            <header id="header" class="header header-breadcrumbs d-flex align-items-center fixed-top bg-light border-bottom">
                <div class="container-xxl bd-gutter position-relative d-flex align-items-center justify-content-between">
                    <a href="index.html" class="logo d-flex align-items-center">
                        <h1 class="sitename">Manual By JS</h1> 
                    </a>
                    <nav id="navmenu" class="navmenu ms-5 me-auto">
                        <div class="c2b5-offcanvas offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
                            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                            <ul class="navmenu-list" id="mbj-menu"> 
                            </ul>
                        </div>
                    </nav>
                    <ul class="header-icons">
                        <li class="icon-btn">
                            <a href="#" data-bs-toggle="modal" data-bs-target="#searchModal">
                                <i class="bi bi-search"></i>
                            </a>
                        </li>
                        <li class="icon-btn">
                            <a href="#" class="ps-0">
                                <i class="bi bi-github"></i>
                            </a>
                        </li>
                        <li class="icon-btn">
                            <a href="#" class="ps-0" onclick="document.body.classList.toggle('page-container-expanded')">
                                <i class="bi bi-arrows-expand-vertical icon-switcher"></i>
                            </a>
                        </li>
                    </ul>
                    <i class="mobile-nav-toggle d-lg-none bi bi-list" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button" aria-controls="offcanvasExample"></i>
                </div>
            </header> 
            <section class="py-4 border-bottom">
                <div class="container-xxl bd-gutter bd-layout no-sidebar">
                    <div class="bd-main">
                        <div id="moveDiv" class="bd-index-table bd-toc mb-5 my-lg-0 ps-xl-3 mb-lg-5 text-muted">
                            <div class="draggable-wrapper">
                                <button class="btn btn-link link-dark p-md-0 mb-2 mb-md-0 text-decoration-none bd-toc-toggle d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#tocContents" aria-expanded="false" aria-controls="tocContents">
                                    <span class="selected-section">On this page</span>
                                    <i class="toggle-index-table bi bi-chevron-expand"></i>
                                </button>
                                <i id="moveDivButton" class="btn-move d-none bi bi-arrows-move"></i>
                            </div>
                            <strong class="d-none d-md-block h6 hide-on-expanded my-2">On this page</strong>
                            <hr class="d-none d-md-block hide-on-expanded my-2">
                            <div class="collapse bd-toc-collapse" id="tocContents">
                                <nav class="index-table" id="mbj-page-index">
                                    <ul>
                                        <li><a href="#title-1">Sed sodales</a>
                                            <ul>
                                                <li><a href="#subtitle-1">Aliquam vitae</a></li>
                                                <li><a href="#subtitle-2">Mauris sapien</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#title-2">Nulla facilisi</a>
                                            <ul>
                                                <li><a href="#subtitle-3">Aliquam purus</a></li>
                                                <li><a href="#subtitle-4">Ut elementum semper</a></li>
                                                <li><a href="#subtitle-5">Morbi id metus</a></li>
                                                <li><a href="#subtitle-6">Vivamus scelerisque</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                        <div class="bd-content pe-lg-2" data-bs-spy="scroll" data-bs-target="#mbj-page-index" data-bs-smooth-scroll="true" class="scrollspy-example-2" tabindex="0" id="restore-selectors">
                            <div id="mbj-page" class="">
                                 
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <div class="py-3 bg-secondary copyright">
                <div class="container px-5"><p class="m-0 text-center text-white">Copyright &copy; C2B5 2025</div>
            </div>
            
            <div class="main-navigator" id="mbj-page-nav">
                <a href="#" class="navigator-item prev-item">
                    <i class="bi bi-caret-left"></i>
                    <span class="page-title-preview pe-2 d-none">Article 1</span>
                </a>
                <a href="#" class="navigator-item next-item">
                    <span class="page-title-preview ps-2 d-none">Article 3</span>
                    <i class="bi bi-caret-right"></i>
                </a>
            </div> 
        </div>
        <div class="modal fade search-modal" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" >
            <div class="modal-dialog">
                <div class="modal-content mt-5">
                    <div class="d-flex">
                        <input type="text" class="form-control shadow-none border-0 form-control-lg" id="searcher-input" placeholder="Type and hit enter..." aria-label="Type and hit enter...">
                        <button type="reset" title="Clear the query" aria-label="Clear the query" class="btn-close mt-2 me-2  btn-lg" onClick="searcher.clear()"></button>
                    </div>
                    <div class="searcher-options"></div>
                    <div class="" id="searcher-progress"></div>
                    <div class="" id="searcher-result"></div>
                </div>
            </div>
        </div>
        
        <a href="#" id="go-to-top" class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up" viewBox="0 0 16 16">
                <use href="assets/icons.svg#arrow-up"></use>
            </svg>
        </a>
<script src="assets/customized_b5.js"></script>
<script src="assets/markdown-it.min.js"></script>
<script src="assets/bundle.min.js"></script>
<script src="assets/search.js"></script>
<script src="assets/manual.js"></script>
<script>
const tourjs = driverJs()
const mkd = markdownit({
                html: true,
                linkify: true,
                typographer: true
            })
mkd.use(markdownItAttrs)
const sprintMenu = [
    {href: "#", title: "0.1.x"}
    ]
const langMenu = [
    {href: "#", title: "EN"},
    {href: "#", title: "CN"},
    {href: "#", title: "JP"},
    {href: "#", title: "FR"},
    {href: "#", title: "VI"},
    ]
const app = new ManualByJs({
    homePage: "page-overview", 
    embedToIframe: [
        {src:"http://192.168.1.166/manual-by-js/assets/driver.js"},
        {href:"http://192.168.1.166/manual-by-js/assets/driver.css"},
        {src:"http://192.168.1.166/manual-by-js/assets/iframe.js"}
    ],
    hook: {
        afterRead: function (content){
            return app.current.fileExt == "md" ? mkd.render(content) : null
        },
        createMenuItem: function(item) { 

            var str = ''
            if(item.slug)
            {
                str = '<li><a href="#'+ app.prefix + item.slug +'" class=" '+ item.slug +'">'+ item.title +'</a></li>'
                if(app.flag && app.counter == app.menu.length)
                {
                    str += '</ul></li>'
                }
            }
            else if(item.href)
            {
                str = '<li><a href="'+ item.href +'" class="" '+ (item.target?'target="'+item.target+'">':'>') + item.title +'</a></li>'
                if(app.flag && app.counter == app.menu.length)
                {
                    str += '</ul></li>'
                }
            }
            else
            {
                if(app.flag)
                {
                    str += '</ul></li>'
                }
                
                str +=  '<li class="dropdown">'+
                    '<a href="#"><span>' + item.title + '</span><i class="bi bi-chevron-down toggle-dropdown"></i></a>'+
                    '<ul class="">'

                app.flag = 1
            }
            
            return str
        },
        afterInit: function()
        { 
            /* menu sprint
            let milestoneMenu = document.getElementById("mbj-sprint")
            milestoneMenu.innerHTML = ''
            for(const item of sprintMenu)
            {
            milestoneMenu.insertAdjacentHTML("beforeend", 
                    '<li><a class="dropdown-item" href="' + item.href + '">'+ item.title +'</a></li>' )
            }
            document.getElementById("mbj-sprint-label").innerHTML =  sprintMenu[0].title

            // menu translate
            let translatorMenu = document.getElementById("mbj-translator")
            for(const item of langMenu)
            {
                translatorMenu.insertAdjacentHTML("beforeend", 
                    '<li><a class="dropdown-item" href="' + item.href + '">'+ item.title +'</a></li>' )
            }*/
            document.querySelectorAll('.navmenu .dropdown').forEach(navmenu => {
                navmenu.addEventListener('click', function(e) {
                    //e.preventDefault();
                    this.querySelector('a').classList.toggle('active');
                    this.querySelector('ul').classList.toggle('dropdown-active');
                    //e.stopImmediatePropagation();
                });
            });
            return true
        },
        createIndexTable: function()
        {   
            if(app.current.index && app.current.index.length > 0)
            {
                document.getElementById("mbj-page").parentElement.parentElement.parentElement.classList.remove('no-index-table')
                app._createDefaultIndexTable()
                new bootstrap.ScrollSpy(document.body, { target: "#mbj-page-index"})
                const textBtnToggle = bdTocToggle.querySelector('.selected-section');
                // const iconBtnToggle = bdTocToggle.querySelector('.bi');
                const firstScrollSpyEl = document.querySelector('[data-bs-spy="scroll"]');

                window.addEventListener('activate.bs.scrollspy', () => {
                    var activeLink = document.querySelector('.bd-toc-collapse a.active');
                    if(window.pageYOffset === 0) textBtnToggle.innerHTML = 'On this page';
                    else textBtnToggle.innerHTML = activeLink.innerHTML; 
                }) 
            }
            else
            {
                document.getElementById("mbj-page").parentElement.parentElement.parentElement.classList.add('no-index-table')
            }
        },
        createPageNav: function(ordering)
        {
            app.mbj.pageNav.innerHTML = ""
            app.prev = app.findPageByOrder(ordering, -1)
            if(false == app.prev)
            {
                app.mbj.pageNav.insertAdjacentHTML("afterbegin", '<a class="invisible"><span>.</span></a>')
            } 
            else 
            {
                app.mbj.pageNav.insertAdjacentHTML("afterbegin", 
                    '<a href="#'+ app.prefix + app.prev.slug+'" class="navigator-item prev-item">' +
                        '<i class="bi bi-caret-left"></i>'+
                    '</a>');
            }

            app.next = app.findPageByOrder(ordering, 1)
            if(false !==  app.next)
            {
                app.mbj.pageNav.insertAdjacentHTML("beforeend", 
                    '<a href="#'+ app.prefix + app.next.slug+'" class="navigator-item next-item">' +
                        '<i class="bi bi-caret-right"></i>' + 
                    '</a>');
            }
        },
        afterNavigate: function(){
            app._afterNavigate()
            if(app.current.tour)
            {
                if(!app.current.iframe){
                    tourjs.setSteps(app.current.tour)
                    tourjs.drive()
                }
            }
            else if(app.current.highlight)
            {
                if(!app.current.iframe){
                    tourjs.setSteps(app.current.tour)
                    tourjs.drive()
                }
            }
        },
        onLoadIframe: function(){
            let frm = document.getElementById("ifrmContent")
            let hd = document.getElementById("header")
            let foot = document.querySelector("div.copyright")
                
            h = window.innerHeight - hd.clientHeight - foot.clientHeight - 125
            console.log(window.innerHeight, hd.clientHeight , foot.clientHeight);
            
            frm.parentElement.style.height = h + "px"
        }
    }
}) 
const searcher = new SearchForManual(app, {
    hook: {
        afterSearching: function(){   
            searcher.sfm.prg.innerHTML = "<p class='ms-3'><i>" + searcher.result.length +" found</i></p>"
            if(searcher.result.length)
            {   
                let lst = '<div class="list-group">'
                for(const item of searcher.result)
                { 
                     lst += `<a href="#${item.link}" class="list-group-item list-group-item-action openModal" data-bs-dismiss="modal">
                            <div class="d-flex w-100 justify-content-between">
                            <h5 class="mb-1">${item.title}</h5> 
                            </div>
                            <p class="mb-1">..${item.found}..</p>
                        </a>`
                }
                lst += '</div>'
                searcher.sfm.res.innerHTML = ''
                searcher.sfm.res.insertAdjacentHTML("afterbegin", lst)
                document.querySelectorAll("a.openModal").forEach((item) => {
                    item.addEventListener('click', () => {  document.location.href = item.href  })
                }) 
            }
            else
            {
                searcher.sfm.res.innerHTML = ""
            }
        },
        onSearching: function( i, page, found){
            searcher.sfm.prg.innerHTML = "<p class='ms-3'><i>" + 
                ( i ? "searching " + i + "/" + searcher.manual.menu.length : "wait for your input" )
                + "</i></p>"
        }
    }
})
</script>
</body>
</html>
